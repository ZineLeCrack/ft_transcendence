{"version":3,"file":"client.js","sources":["../src/client.ts"],"sourcesContent":["const dataMap = new Map<string, () => void>();\nconst importNewFile = (hotModule: string) => {\n\timport(`${hotModule}?import&t=${Date.now()}`).then(() => {\n\t\tconsole.log(`[lent hmr] hot update file ${hotModule}`);\n\t\tdataMap.get(hotModule)?.();\n\t});\n};\n\n(() => {\n\tconsole.log('[lent] connecting...');\n\tconst ws = new WebSocket('ws://localhost:replace_socket_url');\n\tws.addEventListener('open', () => {\n\t\tconsole.log('[lent] connected');\n\t});\n\tws.addEventListener('message', (msg) => {\n\t\ttry {\n\t\t\tconst { hotModule, hot } = JSON.parse(msg.data);\n\t\t\tif (hot) {\n\t\t\t\tconst getParents = hotModule.parent.filter((v) => dataMap.has(v));\n\t\t\t\tconst findLatelyHotParent = getParents[getParents.length - 1];\n\t\t\t\t// eslint-disable-next-line no-empty\n\t\t\t\tif (hotModule.fileName && dataMap.has(hotModule.fileName)) {\n\t\t\t\t\timportNewFile(hotModule.fileName);\n\t\t\t\t} else if (findLatelyHotParent) {\n\t\t\t\t\timportNewFile(findLatelyHotParent);\n\t\t\t\t} else {\n\t\t\t\t\twindow.location.reload();\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tconsole.log(console.log('[lent] message error'));\n\t\t}\n\t});\n})();\n\nexport const createHotContext = (requestFileName: string) => {\n\treturn {\n\t\taccept(callback: () => void) {\n\t\t\tif (!dataMap.has(requestFileName)) {\n\t\t\t\tdataMap.set(requestFileName, callback);\n\t\t\t}\n\t\t}\n\t};\n};\n"],"names":[],"mappings":";;;;;AAAA,MAAM,OAAO,GAAG,IAAI,GAAG,EAAsB,CAAC;AAC9C,MAAM,aAAa,GAAG,CAAC,SAAiB,KAAI;AAC3C,IAAA,OAAO,CAAA,EAAG,SAAS,CAAA,UAAA,EAAa,IAAI,CAAC,GAAG,EAAE,CAAA,CAAE,CAAC,CAAC,IAAI,CAAC,MAAK;AACvD,QAAA,OAAO,CAAC,GAAG,CAAC,8BAA8B,SAAS,CAAA,CAAE,CAAC,CAAC;AACvD,QAAA,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,IAAI,CAAC;AAC5B,KAAC,CAAC,CAAC;AACJ,CAAC,CAAC;AAEF,CAAC,MAAK;AACL,IAAA,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC;AACpC,IAAA,MAAM,EAAE,GAAG,IAAI,SAAS,CAAC,mCAAmC,CAAC,CAAC;AAC9D,IAAA,EAAE,CAAC,gBAAgB,CAAC,MAAM,EAAE,MAAK;AAChC,QAAA,OAAO,CAAC,GAAG,CAAC,kBAAkB,CAAC,CAAC;AACjC,KAAC,CAAC,CAAC;IACH,EAAE,CAAC,gBAAgB,CAAC,SAAS,EAAE,CAAC,GAAG,KAAI;QACtC,IAAI;AACH,YAAA,MAAM,EAAE,SAAS,EAAE,GAAG,EAAE,GAAG,IAAI,CAAC,KAAK,CAAC,GAAG,CAAC,IAAI,CAAC,CAAC;AAChD,YAAA,IAAI,GAAG,EAAE;gBACR,MAAM,UAAU,GAAG,SAAS,CAAC,MAAM,CAAC,MAAM,CAAC,CAAC,CAAC,KAAK,OAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC;gBAClE,MAAM,mBAAmB,GAAG,UAAU,CAAC,UAAU,CAAC,MAAM,GAAG,CAAC,CAAC,CAAC;;AAE9D,gBAAA,IAAI,SAAS,CAAC,QAAQ,IAAI,OAAO,CAAC,GAAG,CAAC,SAAS,CAAC,QAAQ,CAAC,EAAE;AAC1D,oBAAA,aAAa,CAAC,SAAS,CAAC,QAAQ,CAAC,CAAC;AAClC,iBAAA;AAAM,qBAAA,IAAI,mBAAmB,EAAE;oBAC/B,aAAa,CAAC,mBAAmB,CAAC,CAAC;AACnC,iBAAA;AAAM,qBAAA;AACN,oBAAA,MAAM,CAAC,QAAQ,CAAC,MAAM,EAAE,CAAC;AACzB,iBAAA;AACD,aAAA;AACD,SAAA;AAAC,QAAA,OAAO,KAAK,EAAE;YACf,OAAO,CAAC,GAAG,CAAC,OAAO,CAAC,GAAG,CAAC,sBAAsB,CAAC,CAAC,CAAC;AACjD,SAAA;AACF,KAAC,CAAC,CAAC;AACJ,CAAC,GAAG,CAAC;AAEQ,MAAA,gBAAgB,GAAG,CAAC,eAAuB,KAAI;IAC3D,OAAO;AACN,QAAA,MAAM,CAAC,QAAoB,EAAA;AAC1B,YAAA,IAAI,CAAC,OAAO,CAAC,GAAG,CAAC,eAAe,CAAC,EAAE;AAClC,gBAAA,OAAO,CAAC,GAAG,CAAC,eAAe,EAAE,QAAQ,CAAC,CAAC;AACvC,aAAA;SACD;KACD,CAAC;AACH;;;;"}