<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>Pong Client</title>
	<style>
		canvas
		{
			background: black;
			display: block;
			margin: auto;
		}
	</style>
</head>
	<body>
		<canvas id="game" width="400" height="300"></canvas>
		<script>
			const canvas = document.getElementById('game');
			const ctx = canvas.getContext('2d');

			const paddleWidth = 10;
			const paddleHeight = 50;
			const paddleX = 20;

			let paddleY = 100;

			function draw()
			{
				ctx.clearRect(0, 0, canvas.width, canvas.height);
				ctx.fillStyle = 'white';
				ctx.fillRect(paddleX, paddleY, paddleWidth, paddleHeight);
			}

			async function updateState()
			{
				const res = await fetch('http://localhost:3000/state');
				const data = await res.json();
				paddleY = data.padY;
				draw();
			}

			async function sendKey(key)
			{
				await fetch('http://localhost:3000/move',
				{
					method: 'POST',
					headers: { 'Content-Type': 'application/json' },
					body: JSON.stringify({ key }),
				});
			}

			document.addEventListener('keydown', async (e) =>
			{
				if (['ArrowUp', 'ArrowDown'].includes(e.key))
				{
					await sendKey(e.key);
				}
			});
			setInterval(updateState, 100);
		</script>
	</body>
</html>
