{"version":3,"file":"index.js","sources":["../src/middleware/middleware.ts","../src/share.ts","../src/middleware/etag.ts","../src/middleware/router.ts","../src/handleFile.ts","../src/middleware/transform.ts","../src/lent-http.ts","../src/watchFile.ts","../src/depends.ts","../src/wss.ts","../src/plugins/handleNodeModulePlugin.ts","../src/getConfig.ts","../src/plugins/indexRouterPlugin.ts","../src/plugins/handleCssPlugin.ts","../src/plugins/indexHtmlAddClientPlugin.ts","../src/plugins/handleFileImportPlugin.ts","../src/plugins/handleFileWatchPlugin.ts","../src/plugins/handleSocketPortPlugin.ts","../src/plugins/handleCreateLentFileModulePlugin.ts","../src/plugins/handleInjectClientPlugin.ts","../src/plugins/handleEnvPlugin.ts","../src/plugins/handleGlobPlugin.ts","../src/plugins/preCompose.ts","../src/defineLentConfig.ts","../src/index.ts"],"sourcesContent":["// eslint-disable-next-line @typescript-eslint/no-explicit-any\nexport type MiddlewareNext<T = any> = ExpectLink<T>['running'];\n\ninterface ExpectFn<T> {\n\t(value: T, next: MiddlewareNext<T>);\n}\n\n// eslint-disable-next-line @typescript-eslint/no-explicit-any\nclass ExpectLink<T = any> {\n\tpublic expect: ExpectFn<T>;\n\tpublic next: ExpectLink<T> | null;\n\trunning(value?) {\n\t\tconst next = async () => {\n\t\t\tif (this.next) {\n\t\t\t\tawait this.next.running(value);\n\t\t\t}\n\t\t};\n\t\treturn this.expect(value, next);\n\t}\n}\n\nexport class ComposeLink<T> {\n\tprivate prev: ExpectLink<T> = null;\n\tprivate head: ExpectLink<T> = null;\n\tprivate value: T;\n\tconstructor(value?: T) {\n\t\tthis.value = value;\n\t}\n\tpublic use(fn: ExpectFn<T>) {\n\t\tconst link = new ExpectLink();\n\t\tlink.expect = fn;\n\t\tif (!this.head) this.head = link;\n\t\tif (this.prev) this.prev.next = link;\n\t\tthis.prev = link;\n\t\treturn this;\n\t}\n\tpublic run(value?: T) {\n\t\tif (value) {\n\t\t\tthis.value = value;\n\t\t}\n\t\t//执行头节点的入口函数\n\t\treturn this.head.running(this.value);\n\t}\n}\n","import Http from 'http';\n\nexport const isJsFlieRequest = (s: Http.IncomingMessage) => {\n\treturn s.url.endsWith('.js');\n};\n\nexport const handleUrl = (fileUrl: string) => {\n\treturn fileUrl.split('?');\n};\n\nexport const normFileStartWith = (fileName: string) => {\n\tif (fileName.startsWith('/')) {\n\t\treturn `.${fileName}`;\n\t}\n\treturn fileName;\n};\n\nexport const sliceFileDotName = (str: string) => {\n\tif (str && str.startsWith('./')) {\n\t\treturn str.slice(1);\n\t}\n\treturn str;\n};\n\nexport const isLentRequest = (str: string): [string, boolean] => {\n\tif (str.startsWith('/@lent/')) {\n\t\treturn [str.replace('/@lent/', ''), true];\n\t}\n\treturn [str, false];\n};\n\nexport const getLastFileName = (fileName: string) => {\n\tconst lastFileIndex = fileName.lastIndexOf('/');\n\tconst lastFileName = fileName.slice(lastFileIndex);\n\tconst startPath = fileName.slice(0, lastFileIndex);\n\treturn [startPath, lastFileName];\n};\n\nexport const isNodeModuleFile = (fileName: string) => {\n\tif (\n\t\tfileName &&\n\t\t['/', './', '../', '.'].every((v) => !fileName.startsWith(v))\n\t) {\n\t\treturn true;\n\t}\n\treturn false;\n};\n","import { handleUrl } from '../share';\nimport { MiddlewareHttp } from '../types';\nimport { MiddlewareNext } from './middleware';\n\nexport default (middlewareHttp: MiddlewareHttp, next: MiddlewareNext) => {\n\tconst { http, lentInstance } = middlewareHttp;\n\tconst [requestFileName] = handleUrl(http.req.url);\n\tconst model = lentInstance.depend.getDepend(requestFileName);\n\tif (\n\t\tmodel &&\n\t\t(http.req.headers['if-none-match'] === model.etag ||\n\t\t\tmodel.isLentModule === true)\n\t) {\n\t\thttp.res.statusCode = 304;\n\t\treturn http.res.end();\n\t}\n\tif (requestFileName.endsWith('.map')) {\n\t\treturn http.res.end();\n\t}\n\tmiddlewareHttp.mate.requestFileName = requestFileName;\n\tnext();\n};\n","import { MiddlewareHttp } from '../types';\nimport { MiddlewareNext } from './middleware';\n\nexport default (middlewareHttp: MiddlewareHttp, next: MiddlewareNext) => {\n\tconst { http, lentInstance, mate } = middlewareHttp;\n\tconst item = lentInstance.router\n\t\t.getRouters()\n\t\t.find((v) => v.path === mate.requestFileName);\n\n\tconst plugins = lentInstance.plugin;\n\tif (item) {\n\t\tconst indexHtmlPlugin = plugins\n\t\t\t.getPlugins()\n\t\t\t.find((v) => v.name === 'indexHtmlAddClientPlugin');\n\t\tif (indexHtmlPlugin && mate.requestFileName === '/') {\n\t\t\treturn http.res.end(\n\t\t\t\tindexHtmlPlugin.transform(\n\t\t\t\t\titem?.handler(http.req, http.res).toString(),\n\t\t\t\t\t{\n\t\t\t\t\t\tfilePath: 'index.html',\n\t\t\t\t\t\trequestUrl: mate.requestFileName,\n\t\t\t\t\t\tisLentModule: true,\n\t\t\t\t\t\tisModulesFile: false\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t}\n\t\treturn Promise.resolve(item?.handler(http.req, http.res)).then((v) =>\n\t\t\thttp.res.end(v)\n\t\t);\n\t}\n\tnext();\n};\n","import path from 'path';\nimport fs from 'fs';\nimport { LentHttpInstance, TransformPlugin } from './types';\nimport { isLentRequest } from './share';\nimport resolveId from 'resolve';\n\nconst findPackage = (moduleName) => {\n\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\treturn new Promise<Record<string, any>>((r) => {\n\t\tresolveId(\n\t\t\tmoduleName,\n\t\t\t{\n\t\t\t\tpackageFilter(packages) {\n\t\t\t\t\tr(packages);\n\t\t\t\t}\n\t\t\t},\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-empty-function\n\t\t\t() => {}\n\t\t);\n\t});\n};\n\nconst whiteNames = ['client'];\n\n/**\n * 这块需要重点重构\n */\nexport const isHaveFile = async (\n\trequireName: string,\n\trawRequireName: string,\n\tlentHttpInstance: LentHttpInstance\n): Promise<[string, boolean, boolean]> => {\n\tlet fileRoot = lentHttpInstance.config.root;\n\tlet isModulesFile = false;\n\t// eslint-disable-next-line prefer-const\n\tlet [convertFileName, isLentStart] = isLentRequest(rawRequireName);\n\tif (isLentStart && whiteNames.some((v) => convertFileName === v)) {\n\t\tfileRoot = __dirname;\n\t\tconvertFileName += '.js';\n\t} else if (isLentStart) {\n\t\tfileRoot = process.cwd();\n\t\ttry {\n\t\t\tconst filePackage = await findPackage(convertFileName);\n\t\t\tconst fileRoot = filePackage.module || filePackage.main;\n\t\t\tif (filePackage.module) {\n\t\t\t\tisModulesFile = true;\n\t\t\t}\n\t\t\tconvertFileName = path.join('/node_modules', convertFileName, fileRoot);\n\t\t} catch (e) {\n\t\t\tconsole.warn(\n\t\t\t\t`[lent warn] no find module ${convertFileName} do you have install ?`\n\t\t\t);\n\t\t\treturn ['', false, false];\n\t\t}\n\t} else {\n\t\tconvertFileName = requireName;\n\t}\n\n\tconst filePath = path.join(fileRoot, convertFileName);\n\n\tif (fs.existsSync(filePath)) {\n\t\treturn [filePath, isLentStart, isModulesFile];\n\t}\n\treturn ['', isLentStart, false];\n};\n\nexport const findFile = async (\n\trequireName: string,\n\tfileExit: Array<string>,\n\tlentHttpInstance: LentHttpInstance\n): Promise<[string, boolean, boolean]> => {\n\tconst [f, isLentModule, isModulesFile] = await isHaveFile(\n\t\trequireName,\n\t\trequireName,\n\t\tlentHttpInstance\n\t);\n\tif (f) return [f, isLentModule, isModulesFile];\n\tfor (const exitName of fileExit) {\n\t\tconst [f, isLentModule] = await isHaveFile(\n\t\t\trequireName + exitName,\n\t\t\trequireName,\n\t\t\tlentHttpInstance\n\t\t);\n\t\tif (f) {\n\t\t\treturn [f, isLentModule, isModulesFile];\n\t\t}\n\t}\n\treturn ['', isLentModule, isModulesFile];\n};\n\nexport const transform = async (\n\trequestFileName: string,\n\tplugins: () => Array<TransformPlugin>,\n\tlentHttpInstance: LentHttpInstance\n) => {\n\tlet fileData = '';\n\tconst [filePath, isLentModule, isModulesFile] = await findFile(\n\t\trequestFileName,\n\t\tlentHttpInstance.config.extensions,\n\t\tlentHttpInstance\n\t);\n\n\tconst filterPlugins = plugins().filter((v) => {\n\t\tif (requestFileName.endsWith(v.exit) || filePath.endsWith(v.exit)) {\n\t\t\treturn true;\n\t\t} else if (\n\t\t\tv.exits?.some(\n\t\t\t\t(vv) => requestFileName.includes(vv) || filePath.endsWith(vv)\n\t\t\t)\n\t\t) {\n\t\t\treturn true;\n\t\t}\n\t});\n\tif (filePath) {\n\t\tfileData = fs.readFileSync(filePath).toString();\n\t}\n\tconst fileUrl = {\n\t\tfilePath,\n\t\trequestUrl: requestFileName,\n\t\tisLentModule: isLentModule,\n\t\tisModulesFile\n\t};\n\tconst reduces = (prev: Promise<string>, next: TransformPlugin) => {\n\t\treturn prev.then((value) =>\n\t\t\tnext.transform(value, fileUrl, lentHttpInstance)\n\t\t);\n\t};\n\t//这里可以单独抽离为一个库\n\treturn plugins()\n\t\t.filter((v) => v.enforce === 'pre')\n\t\t.reduce(reduces, Promise.resolve(fileData))\n\t\t.then((fileSource) =>\n\t\t\tfilterPlugins.reduce(reduces, Promise.resolve(fileSource))\n\t\t)\n\t\t.then((fileSource) => {\n\t\t\treturn plugins()\n\t\t\t\t.filter((v) => v.enforce === 'post')\n\t\t\t\t.reduce(reduces, Promise.resolve(fileSource));\n\t\t})\n\t\t.catch((e) => {\n\t\t\tconsole.log('[lent error]', e);\n\t\t});\n};\n","import { transform } from '../handleFile';\nimport { MiddlewareHttp } from '../types';\nimport { MiddlewareNext } from './middleware';\n\nexport default (middlewareHttp: MiddlewareHttp, next: MiddlewareNext) => {\n\tconst { http, lentInstance, mate } = middlewareHttp;\n\tconst plugins = lentInstance.plugin;\n\ttransform(mate.requestFileName, plugins.getPlugins, lentInstance).then(\n\t\t(transformValue) => {\n\t\t\tconst fileValue = transformValue || '';\n\t\t\tconst etag = lentInstance.depend.getDepend(mate.requestFileName)?.etag;\n\t\t\thttp.res.setHeader('content-Type', 'text/javascript');\n\t\t\tif (etag) {\n\t\t\t\thttp.res.setHeader('Etag', etag);\n\t\t\t}\n\t\t\thttp.res.end(fileValue);\n\t\t}\n\t);\n\tnext();\n};\n","import Http from 'http';\nimport path from 'path';\nimport { Socket } from 'net';\nimport { ComposeLink } from './middleware/middleware';\nimport {\n\tLentHttpInstance,\n\tMiddlewareHttp,\n\tRouter as TypeRouter\n} from './types';\nimport etagMiddle from './middleware/etag';\nimport routerMiddle from './middleware/router';\nimport transformMiddle from './middleware/transform';\nconst pkg = require(path.resolve(__dirname, `../package.json`));\n\nexport const router = (): LentHttpInstance['router'] => {\n\tconst routers = new Set<TypeRouter>();\n\treturn {\n\t\taddRouter(router: TypeRouter) {\n\t\t\trouters.add(router);\n\t\t},\n\t\tgetRouters() {\n\t\t\treturn [...routers];\n\t\t}\n\t};\n};\n\nexport const createHttp = (\n\tlentInstance: LentHttpInstance\n): LentHttpInstance['http'] => {\n\tconst http = Http.createServer();\n\treturn {\n\t\thttp: () => http,\n\t\tstart() {\n\t\t\thttp.on('upgrade', (req, socket, head) => {\n\t\t\t\tlentInstance.socket.webSocket.handleUpgrade(\n\t\t\t\t\treq,\n\t\t\t\t\tsocket as Socket,\n\t\t\t\t\thead,\n\t\t\t\t\t(ws) => {\n\t\t\t\t\t\tlentInstance.socket.webSocket.emit('connection', ws, req);\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t});\n\n\t\t\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\tconst middleware = new ComposeLink<MiddlewareHttp>();\n\t\t\tmiddleware.use(etagMiddle).use(routerMiddle);\n\t\t\tlentInstance.config?.middle?.forEach((v) => middleware.use(v));\n\t\t\tmiddleware.use(transformMiddle);\n\t\t\thttp\n\t\t\t\t.on('request', (req, res) => {\n\t\t\t\t\tmiddleware.run({\n\t\t\t\t\t\tlentInstance,\n\t\t\t\t\t\thttp: {\n\t\t\t\t\t\t\treq,\n\t\t\t\t\t\t\tres\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmate: {}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.listen(lentInstance.config.port, () => {\n\t\t\t\t\tconsole.log(`lent v${pkg.version} dev server running at:`);\n\t\t\t\t\tconsole.log(`> Local: http://localhost:${lentInstance.config.port}/`);\n\t\t\t\t\tconsole.log(\n\t\t\t\t\t\t`> running time ${\n\t\t\t\t\t\t\tDate.now() - lentInstance.performance.startTime\n\t\t\t\t\t\t}ms`\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t}\n\t};\n};\n","import chokidar from 'chokidar';\nimport { LentHttpInstance, FileCallback, FileUrl } from './types';\n\nexport const createWatchFile = (l: LentHttpInstance) => {\n\tconst watcher = chokidar\n\t\t.watch([], {\n\t\t\tpersistent: true\n\t\t})\n\t\t.on('change', (path) => l.watchFileEvent.emit('change', path));\n\treturn watcher;\n};\n\nexport const handleWatchFileEvent = () => {\n\tconst fileWatchEvent = new Map<string, Array<FileCallback>>();\n\treturn {\n\t\ton(eventName: string, fileCallback: FileCallback) {\n\t\t\tif (!fileWatchEvent.has(eventName)) {\n\t\t\t\tfileWatchEvent.set(eventName, [fileCallback]);\n\t\t\t} else {\n\t\t\t\tconst fileRegister = fileWatchEvent.get(eventName);\n\t\t\t\tif (!fileRegister.some((v) => v.filePath === fileCallback.filePath)) {\n\t\t\t\t\tfileWatchEvent.get(eventName).push(fileCallback);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\temit(eventName: string, path: string) {\n\t\t\tconst event = fileWatchEvent.get(eventName);\n\t\t\tif (event) {\n\t\t\t\tevent.forEach((v) => {\n\t\t\t\t\tif (v.filePath === path) v.callback();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport const addFileChange = (\n\tl: LentHttpInstance,\n\tfileUrl: FileUrl,\n\tcallback: () => void\n) => {\n\tl.watchFileEvent.on('change', {\n\t\tfilePath: fileUrl.filePath,\n\t\tcallback: () => {\n\t\t\tconsole.log(`[lent] update file ${fileUrl.requestUrl}`);\n\t\t\tcallback();\n\t\t}\n\t});\n\tl.watch.add(fileUrl.filePath);\n};\n","import { ImportSpecifier } from 'es-module-lexer';\nimport { normFileStartWith, getLastFileName } from './share';\nimport { LentHttpInstance } from './types';\n\nexport interface LentModuleDepends {\n\timportFile: Array<ImportSpecifier>;\n\tetag: string;\n\trequestUrl: string;\n\thash: string;\n\tisLentModule: boolean;\n\tisModulesFile: boolean;\n}\n\nexport const createLentModuleDepend = <T extends Partial<LentModuleDepends>>(\n\tm: T\n): T => {\n\treturn {\n\t\tetag: '',\n\t\trequestUrl: '',\n\t\timportFile: [],\n\t\thash: '',\n\t\tisLentModule: true,\n\t\tisModulesFile: false,\n\t\t...m\n\t};\n};\n\nexport const depends = (): LentHttpInstance['depend'] => {\n\tconst dependGraph = new Map<string, LentModuleDepends>();\n\treturn {\n\t\tgetGraph: () => dependGraph,\n\t\tgetDepend: (fileName: string) => dependGraph.get(fileName),\n\t\taddDepend(fileName: string, lentModule: LentModuleDepends) {\n\t\t\tif (!dependGraph.has(fileName)) {\n\t\t\t\tdependGraph.set(fileName, lentModule);\n\t\t\t}\n\t\t}\n\t};\n};\n\nexport const getDependsParent = (\n\tmoduleFileName: string,\n\tdepends: LentHttpInstance['depend']\n): Array<string> => {\n\tconst depMap = depends.getGraph();\n\t// const findParents = [];\n\tconst walkDepend = (fileName: string) => {\n\t\tfor (const [modulePath, moduleValue] of depMap) {\n\t\t\tconst [lastStartPath, lastFileName] = getLastFileName(fileName);\n\t\t\tconst [lastModulePath] = getLastFileName(modulePath);\n\t\t\tconst covFileName =\n\t\t\t\tlastModulePath === lastStartPath ? lastFileName : fileName;\n\n\t\t\tif (modulePath !== fileName) {\n\t\t\t\tconst haveParent = moduleValue.importFile.some(\n\t\t\t\t\t(i) => i.n === normFileStartWith(covFileName)\n\t\t\t\t);\n\t\t\t\tif (haveParent) {\n\t\t\t\t\t// findParents.unshift(modulePath);\n\t\t\t\t\treturn [...walkDepend(modulePath), modulePath];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t};\n\treturn walkDepend(moduleFileName);\n\t// return findParents;\n};\n\nexport const setDependsAddHash = (\n\tfileNames: Array<string>,\n\tdepends: LentHttpInstance['depend']\n) => {\n\tfileNames.forEach((v) => {\n\t\tconst fileDepend = depends.getDepend(v);\n\t\tif (fileDepend) {\n\t\t\tfileDepend.hash = Date.now().toString();\n\t\t}\n\t});\n};\n","import { WebSocketServer } from 'ws';\n\nexport const createWss = () => {\n\tconst webSocket = new WebSocketServer({\n\t\tnoServer: true\n\t});\n\tconst sendSocket = (v: object) => {\n\t\twebSocket.clients.forEach((socket) => {\n\t\t\tsocket.send(JSON.stringify(v));\n\t\t});\n\t};\n\twebSocket.on('connection', (socket) => {\n\t\tsocket.send(JSON.stringify({ type: 'connected' }));\n\t\t// socket.on(\"message\", (msg) => {})\n\t});\n\treturn {\n\t\twebSocket,\n\t\tsendSocket\n\t};\n};\n","import { LentPlugin } from './preCompose';\nimport { transformSync } from '@babel/core';\n\nexport const transformSyncCode = (code, otherPresets = []) => {\n\treturn transformSync(code, {\n\t\t// sourceMaps: 'inline',\n\t\tpresets: [['babel-preset-typescript'], ...otherPresets]\n\t}).code;\n};\n\nexport const handleNodeModulePlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleNodeModulePlugin',\n\t\tenforce: 'post',\n\t\tasync transform(v, file) {\n\t\t\tif (file.isLentModule && file.isModulesFile) {\n\t\t\t\treturn v;\n\t\t\t}\n\t\t\tif (!file.isLentModule || file.requestUrl.endsWith('.ts')) {\n\t\t\t\treturn transformSyncCode(v);\n\t\t\t}\n\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import path from 'path';\nimport fs from 'fs';\nimport { LentHttpInstance } from './types';\nimport { transformSyncCode } from './plugins/handleNodeModulePlugin';\n\nexport const getConfig = (lentHttpInstance: LentHttpInstance) => {\n\tconst cwd = process.cwd();\n\tconst configPaths = [\n\t\tpath.join(cwd, '/lent.config.js'),\n\t\tpath.join(cwd, '/lent.config.ts')\n\t];\n\tconst defineConfig = configPaths.find((configPath) =>\n\t\tfs.existsSync(configPath)\n\t);\n\tlet config: LentHttpInstance['config'] = {};\n\tif (defineConfig) {\n\t\tconst extension = path.extname(defineConfig);\n\t\tconst defaultLoader = require.extensions[extension];\n\t\trequire.extensions[extension] = (module, requiredFileName) => {\n\t\t\tif (requiredFileName === defineConfig) {\n\t\t\t\t// eslint-disable-next-line @typescript-eslint/no-explicit-any\n\t\t\t\t(module as any)._compile(\n\t\t\t\t\ttransformSyncCode(fs.readFileSync(defineConfig), [\n\t\t\t\t\t\t[\n\t\t\t\t\t\t\t'@babel/preset-env',\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\ttargets: {\n\t\t\t\t\t\t\t\t\tnode: 'current'\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t]\n\t\t\t\t\t]),\n\t\t\t\t\trequiredFileName\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tif (defaultLoader) {\n\t\t\t\t\tdefaultLoader(module, requiredFileName);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst requireConfig = require(defineConfig);\n\t\tconfig = requireConfig.default || requireConfig;\n\t}\n\n\tif (config.plugin) {\n\t\tconfig.plugin(lentHttpInstance);\n\t}\n\treturn {\n\t\troot: cwd,\n\t\tport: 3000,\n\t\textensions: ['.js', '.ts', '.css'],\n\t\t...config\n\t};\n};\n","import fs from 'fs';\nimport path from 'path';\nimport { addFileChange } from '../watchFile';\nimport { createLentModuleDepend } from '../depends';\nimport { LentPlugin } from './preCompose';\n\nexport const indexRouterPlugin: LentPlugin = (l) => {\n\tl.router.addRouter({\n\t\tmethod: 'GET',\n\t\tpath: '/',\n\t\thandler() {\n\t\t\tconst indexPath = path.join(l.config.root, './index.html');\n\t\t\tl.depend.addDepend(\n\t\t\t\tindexPath,\n\t\t\t\tcreateLentModuleDepend({\n\t\t\t\t\timportFile: []\n\t\t\t\t})\n\t\t\t);\n\t\t\taddFileChange(\n\t\t\t\tl,\n\t\t\t\t{\n\t\t\t\t\tfilePath: indexPath,\n\t\t\t\t\trequestUrl: indexPath,\n\t\t\t\t\tisLentModule: true,\n\t\t\t\t\tisModulesFile: false\n\t\t\t\t},\n\t\t\t\t() => {\n\t\t\t\t\tl.socket.sendSocket({\n\t\t\t\t\t\thotModule: {\n\t\t\t\t\t\t\tfileName: indexPath,\n\t\t\t\t\t\t\tparent: []\n\t\t\t\t\t\t},\n\t\t\t\t\t\thot: true\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t);\n\t\t\treturn fs.readFileSync(indexPath);\n\t\t}\n\t});\n};\n","import { LentPlugin } from './preCompose';\n\nexport const handleCssPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\texit: '.css',\n\t\tname: 'handleCssPlugin',\n\t\ttransform: (v, fileName) => {\n\t\t\treturn `\n                const styles =  [...document.querySelectorAll(\"style\")];\n                const style = styles.find(v=>v.title === '${\n\t\t\t\t\t\t\t\t\tfileName.requestUrl\n\t\t\t\t\t\t\t\t}');\n                if(style){\n                    style.innerHTML = '${v.toString().replace(/\\n|\\r/g, '')}';\n                }else{\n                    const style = document.createElement('style');\n                    style.setAttribute('type', 'text/css');\n                    style.title = '${fileName.requestUrl}';\n                    style.innerHTML = '${v.toString().replace(/\\n|\\r/g, '')}';\n                    document.head.appendChild(style);\n                }\n                if (import.meta.hot) {\n                    import.meta.hot.accept(() => {});\n                }\n                `;\n\t\t}\n\t});\n};\n","import cheerio from 'cheerio';\nimport { LentPlugin } from './preCompose';\n\nexport const indexHtmlAddClientPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'indexHtmlAddClientPlugin',\n\t\ttransform(v) {\n\t\t\tconst $ = cheerio.load(v);\n\t\t\t$('head').append(`<script type='module' src='/@lent/client' />`);\n\t\t\treturn $.html();\n\t\t}\n\t});\n};\n","import { parse, init } from 'es-module-lexer';\nimport MagicString from 'magic-string';\nimport { sliceFileDotName, isNodeModuleFile } from '../share';\nimport { LentPlugin } from './preCompose';\n\nexport const handleFileImportPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleFileImportPlugin',\n\t\texits: ['.js', '.ts', '.tsx', '.mjs', '.mts'],\n\t\tasync transform(v, file, i) {\n\t\t\tawait init;\n\t\t\tconst [imports] = parse(v);\n\t\t\tconst dependModule = i.depend.getDepend(file.requestUrl);\n\t\t\tdependModule.importFile = [...imports];\n\t\t\tconst s = new MagicString(v);\n\t\t\timports.forEach((importItem) => {\n\t\t\t\tconst childModule = i.depend.getDepend(sliceFileDotName(importItem.n));\n\t\t\t\tif (childModule && childModule.hash) {\n\t\t\t\t\ts.overwrite(\n\t\t\t\t\t\timportItem.s,\n\t\t\t\t\t\timportItem.e,\n\t\t\t\t\t\t`${importItem.n}?t=${childModule.hash}`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif (isNodeModuleFile(importItem.n)) {\n\t\t\t\t\ts.overwrite(importItem.s, importItem.e, `/@lent/${importItem.n}`);\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn s.toString();\n\t\t}\n\t});\n};\n","import { getDependsParent, setDependsAddHash } from 'src/depends';\nimport { addFileChange } from '../watchFile';\nimport { LentPlugin } from './preCompose';\n\nexport const handleFileWatchPlugin: LentPlugin = (l) => {\n\tconst setFileEtag = (requestUrl: string, isSend: boolean) => {\n\t\tconst dependModule = l.depend.getDepend(requestUrl);\n\t\tdependModule.etag = Date.now().toString();\n\t\tif (isSend) {\n\t\t\tconst moduleParent = getDependsParent(requestUrl, l.depend);\n\t\t\tif (moduleParent.length) {\n\t\t\t\tsetDependsAddHash([...moduleParent.slice(1), requestUrl], l.depend);\n\t\t\t}\n\t\t\tl.socket.sendSocket({\n\t\t\t\thotModule: {\n\t\t\t\t\tfileName: requestUrl,\n\t\t\t\t\tparent: moduleParent\n\t\t\t\t},\n\t\t\t\thot: true\n\t\t\t});\n\t\t}\n\t};\n\tl.plugin.addPlugins({\n\t\tname: 'handleFileWatchPlugin',\n\t\tenforce: 'post',\n\t\ttransform: (v, file, i) => {\n\t\t\tconst dependModule = i.depend.getDepend(file.requestUrl);\n\t\t\tsetFileEtag(file.requestUrl, false);\n\t\t\tif (dependModule && file.filePath && !file.isLentModule) {\n\t\t\t\taddFileChange(i, file, () => {\n\t\t\t\t\tsetFileEtag(file.requestUrl, true);\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import { LentPlugin } from './preCompose';\n\nexport const handleSocketPortPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleSocketPortPlugin',\n\t\tenforce: 'post',\n\t\ttransform(fileData, fileUrl, v) {\n\t\t\tif (fileUrl.requestUrl.includes('client')) {\n\t\t\t\treturn fileData.replace('replace_socket_url', v.config.port.toString());\n\t\t\t}\n\t\t\treturn fileData;\n\t\t}\n\t});\n};\n","import { createLentModuleDepend } from '../depends';\nimport { LentPlugin } from './preCompose';\n\nexport const handleCreateLentFileModulePlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleCreateLentFileModulePlugin',\n\t\tenforce: 'pre',\n\t\ttransform(v, file, i) {\n\t\t\ti.depend.addDepend(\n\t\t\t\tfile.requestUrl,\n\t\t\t\tcreateLentModuleDepend({\n\t\t\t\t\trequestUrl: file.requestUrl,\n\t\t\t\t\tisLentModule: file.isLentModule\n\t\t\t\t})\n\t\t\t);\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import { LentPlugin } from './preCompose';\n\nexport const handleInjectClientPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleFileImportPlugin',\n\t\tenforce: 'post',\n\t\ttransform(v, file) {\n\t\t\tif (\n\t\t\t\t!file.isLentModule &&\n\t\t\t\t['.js', '.ts', '.tsx', '.mjs', '.mts', '.css'].some((v) =>\n\t\t\t\t\tfile.filePath.endsWith(v)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn `import { createHotContext } from \"/@lent/client\";\n            import.meta.hot = createHotContext('${file.requestUrl}');\n            ${v};\n           `;\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import { LentPlugin } from './preCompose';\n\nexport const handleEnvPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleEnvPlugin',\n\t\tenforce: 'post',\n\t\ttransform(v, file) {\n\t\t\tif (\n\t\t\t\t['.js', '.ts', '.tsx', '.mjs', '.mts'].some((v) =>\n\t\t\t\t\tfile.filePath.endsWith(v)\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn `\n                var process = {\n                    env:{\n                        NODE_ENV:'development'\n                    }\n                }\n                ${v}\n                `;\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import path from 'path';\nimport { glob } from 'glob';\nimport { LentPlugin } from './preCompose';\nimport MagicString from 'magic-string';\n\nexport const handleGlobPlugin: LentPlugin = (l) => {\n\tl.plugin.addPlugins({\n\t\tname: 'handleGlobPlugin',\n\t\texits: ['.js', '.ts', '.tsx', '.mjs', '.mts'],\n\t\ttransform(v, file, i) {\n\t\t\tif (v) {\n\t\t\t\tconst globIndex = v.indexOf('import.meta.glob(');\n\t\t\t\tif (globIndex > -1) {\n\t\t\t\t\tconst endIndex = v.indexOf(`)`, globIndex);\n\t\t\t\t\tconst globStart = globIndex + 'import.meta.glob('.length + 1;\n\t\t\t\t\tconst pattern = v.slice(globStart, endIndex - 1);\n\t\t\t\t\tconst files = glob.sync(pattern, {\n\t\t\t\t\t\tcwd: path.join(process.cwd(), i.config.root),\n\t\t\t\t\t\tignore: ['**/node_modules/**']\n\t\t\t\t\t});\n\t\t\t\t\tconst overwriteCode = new MagicString('');\n\t\t\t\t\toverwriteCode.prepend('{');\n\t\t\t\t\tfiles.forEach((v) => {\n\t\t\t\t\t\toverwriteCode.append(`'${v}':()=>import('${v}'),`);\n\t\t\t\t\t});\n\t\t\t\t\toverwriteCode.append('}');\n\t\t\t\t\tconst s = new MagicString(v);\n\t\t\t\t\ts.overwrite(globIndex, endIndex + 1, overwriteCode.toString());\n\t\t\t\t\treturn s.toString();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn v;\n\t\t}\n\t});\n};\n","import { TransformPlugin, LentHttpInstance } from '../types';\nimport { indexRouterPlugin } from './indexRouterPlugin';\nimport { handleCssPlugin } from './handleCssPlugin';\nimport { indexHtmlAddClientPlugin } from './indexHtmlAddClientPlugin';\nimport { handleFileImportPlugin } from './handleFileImportPlugin';\nimport { handleFileWatchPlugin } from './handleFileWatchPlugin';\nimport { handleSocketPortPlugin } from './handleSocketPortPlugin';\nimport { handleCreateLentFileModulePlugin } from './handleCreateLentFileModulePlugin';\nimport { handleInjectClientPlugin } from './handleInjectClientPlugin';\nimport { handleNodeModulePlugin } from './handleNodeModulePlugin';\nimport { handleEnvPlugin } from './handleEnvPlugin';\nimport { handleGlobPlugin } from './handleGlobPlugin';\n\nexport type LentPlugin = (l: LentHttpInstance) => void;\n\nexport const plugins = (): LentHttpInstance['plugin'] => {\n\tconst plugins: Array<TransformPlugin> = [];\n\treturn {\n\t\taddPlugins(p: TransformPlugin) {\n\t\t\tplugins.push(p);\n\t\t},\n\t\tgetPlugins() {\n\t\t\treturn plugins;\n\t\t}\n\t};\n};\n\nexport const preCompose = (): Array<LentPlugin> => {\n\treturn [\n\t\tindexRouterPlugin,\n\t\tindexHtmlAddClientPlugin,\n\t\thandleCssPlugin,\n\t\thandleFileImportPlugin,\n\t\thandleCreateLentFileModulePlugin,\n\t\thandleFileWatchPlugin,\n\t\thandleNodeModulePlugin,\n\t\thandleInjectClientPlugin,\n\t\thandleSocketPortPlugin,\n\t\thandleGlobPlugin,\n\t\thandleEnvPlugin\n\t];\n};\n\nexport const applyComposePlugin = (l: LentHttpInstance) => {\n\tpreCompose().forEach((p) => p(l));\n};\n","import { LentHttpInstance } from './types';\n\n// eslint-disable-next-line @typescript-eslint/no-empty-function\nexport const defineLentConfig = <T extends Partial<LentHttpInstance['config']>>(\n\tl: T\n): T => {\n\treturn l;\n};\n","import { router, createHttp } from './lent-http';\nimport { LentHttpInstance } from './types';\nimport { createWatchFile, handleWatchFileEvent } from './watchFile';\nimport { depends } from './depends';\nimport { createWss } from './wss';\nimport { getConfig } from './getConfig';\nimport { plugins, applyComposePlugin } from './plugins/preCompose';\nexport { defineLentConfig } from './defineLentConfig';\n\nexport const lent = (): LentHttpInstance => {\n\tconst lentInstance_ = {\n\t\tperformance: {\n\t\t\tstartTime: Date.now()\n\t\t},\n\t\twatchFileEvent: handleWatchFileEvent(),\n\t\trouter: router(),\n\t\tplugin: plugins(),\n\t\tdepend: depends(),\n\t\tconfig: null,\n\t\tsocket: null,\n\t\twatch: null,\n\t\thttp: null\n\t};\n\tlentInstance_.watch = createWatchFile(lentInstance_);\n\tlentInstance_.socket = createWss();\n\tlentInstance_.http = createHttp(lentInstance_);\n\tlentInstance_.config = getConfig(lentInstance_);\n\tapplyComposePlugin(lentInstance_);\n\treturn lentInstance_;\n};\n\nif (process.env.LENT_DEV) {\n\tlent().http.start();\n}\n"],"names":["resolveId","path","fs","Http","chokidar","WebSocketServer","transformSync","cheerio","init","parse","MagicString","glob"],"mappings":"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"}